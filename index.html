<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixi.js Canvas Background and Car Sprite</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        canvas {
            background-color: #333333; /* Added background color to the canvas */
        }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.2.1/pixi.min.js"></script>
    <script>
        // Initialize the Pixi Application
        const app = new PIXI.Application({ width: 800, height: 1000 });
        document.body.appendChild(app.view);

        // Draw the road
        const road = new PIXI.Graphics();
        road.beginFill(0x333333); // Road color
        road.drawRect(100, 0, 600, 1000); // Adjusted road dimensions
        road.endFill();
        app.stage.addChild(road); // Add road to the stage first

        // Draw the lane markings
        const laneMarkings = new PIXI.Graphics();
        laneMarkings.lineStyle(4, 0xFFFFFF, 1);

        // Calculate lane width and positions
        const laneWidth = 600 / 4; // Four lanes
        const startX = 100;

        // Draw lane markings for four lanes
        for (let i = 0; i < 1000; i += 40) { // Adjusted loop to match new height
            for (let j = 1; j < 4; j++) { // Three lines to separate four lanes
                laneMarkings.moveTo(startX + j * laneWidth, i);
                laneMarkings.lineTo(startX + j * laneWidth, i + 20);
            }
        }
        app.stage.addChild(laneMarkings); // Add lane markings to the stage

        // Load the car image
        const carTexture = PIXI.Texture.from('img/car.png');
        const car = new PIXI.Sprite(carTexture);

        // Set the car's position and size
        car.width = 150;
        car.height = 150;
        car.x = app.screen.width / 2 - car.width / 2; // Center horizontally
        car.y = app.screen.height - car.height - 50; // Position in the lower half

        // Add the car to the stage
        app.stage.addChild(car);

        // Keyboard controls
        const keys = {};
        window.addEventListener('keydown', (e) => {
            keys[e.code] = true;
        });
        window.addEventListener('keyup', (e) => {
            keys[e.code] = false;
        });

        app.ticker.add(() => {
            // Move car left
            if (keys['ArrowLeft'] || keys['KeyA']) {
                car.x -= 5;
                if (car.x < 100) {
                    car.x = 100; // Keep the car within the left boundary
                }
            }
            // Move car right
            if (keys['ArrowRight'] || keys['KeyD']) {
                car.x += 5;
                if (car.x > app.screen.width - car.width - 100) {
                    car.x = app.screen.width - car.width - 100; // Keep the car within the right boundary
                }
            }
            // Move car up
            if (keys['ArrowUp'] || keys['KeyW']) {
                car.y -= 5;
                if (car.y < 0) {
                    car.y = 0; // Keep the car within the upper boundary
                }
            }
            // Move car down
            if (keys['ArrowDown'] || keys['KeyS']) {
                car.y += 5;
                if (car.y > app.screen.height - car.height) {
                    car.y = app.screen.height - car.height; // Keep the car within the lower boundary
                }
            }

            // Animate the lane markings to simulate a moving road
            laneMarkings.y += 2;
            if (laneMarkings.y > 40) {
                laneMarkings.y = 0;
            }
        });
    </script>
</body>
</html>
